class TestNetwork extends TestCase {
    Run() {
        let inputs = new Float64Array([-0.5407, -0.6894, -0.209,  0.3919,  0.0227,  0.0302,  0.6816, -0.3554,  0.7573, -0.2103, -0.108, -0.1931, -0.9254, -0.8819, -0.1715, -0.148, -0.5127, -0.2434,  0.4454, -0.5939, -0.0645,  0.1535,  0.1206, -0.2742, -0.9054, -0.5849, -0.4333, -0.5497, -0.1467, -0.0872,  0.7262,  0.1866, -0.1341,  0.6894, -0.8854, -0.484800000000000])
        let labels = new Float64Array([-1, 1, 1, -1, -1, -1, 1, 1, -1, -1, 1, 1])
        let data = new Data(inputs, labels, 3)

        let runs = [
            {
                name: "Dense 3-5-1 (abs activation)",
                layers: [
                    {
                        size: 5,
                        activation: "abs",
                        w: [-0.30159443616867065, 0.016445718705654144, -0.5161601305007935, 0.3578687906265259, -0.24612334370613098, 0.5476146340370178, -0.4761962890625, 0.22579234838485718, -0.10585948824882507, 0.06492820382118225, -0.20185504853725433, 0.08487679064273834, -0.027813147753477097, -0.23444661498069763, -0.10803285986185074],
                        b: [-0.07460954040288925, 0.3149145841598511, 0.5576653480529785, -0.019843289628624916, -0.14266538619995117]
                    },
                    {
                        size: 1,
                        activation: "",
                        w: [-0.19489341974258423, -0.123634934425354, -0.18226519227027893, 0.02998742088675499, 0.3258719742298126],
                        b: [0.2790389358997345]
                    },
                ],
                steps: {
                    0: {
                        loss: 0.4814391310223827,
                        output: new Float64Array([-0.027295252716712542, 0.08572442211207032, 0.22035809089287706, 0.006543238310567606, -0.07085204117342325, 0.01756583048478591, 0.0983882482838229, 0.045443829164483196, -0.0819072507791829, -0.030873701377865576, 0.11754216640167636, 0.11664438135828319]),
                        w: [-0.4885942310580633, -0.17055425512863412, -0.7031597243073129, 0.17086882879560553, -0.4331082327328172, 0.3606147538736788, -0.6631962655860082, 0.038792411299309826, -0.2928593838021881, 0.25192789408046357, -0.01485537784922808, 0.2718757686353055, 0.1591865789313305, -0.047446642695293056, 0.07896660107645384],
                        b: [0.11239044748770355, 0.12791469590390042, 0.7446648609115626, -0.2068229689758356, -0.3296653733642382]
                    },
                    1: {
                        loss: 0.4319441758816227,
                        output: new Float64Array([-0.8657859383968964, -0.19653694789857468, 0.10277732307098733, -0.5956156579643725, -1.078202801389806, -0.6491389642755686, -0.2503239358573392, -0.39160121905317646, -1.113701151463064, -0.7381370560749814, -0.080536314414595, -0.3162276775385513]),
                        w: [-0.49126373757676034, -0.2912988315171553, -0.609946280717308, 0.1288632907867525, -0.29489442262757604, 0.2205199092989931, -0.8429650592910987, -0.14584135231873097, -0.4785570645980959, 0.12140704643001621, -0.13326553084651116, 0.2249550846424901, 0.023498748928806823, -0.05084173717548119, -0.05031549130792759],
                        b: [0.23899568068552582, -0.03229452695703516, 0.8574727044706804, -0.06795161984333054, -0.42769127303742266]
                    },
                    42: {
                        loss: 0.015191448285977904,
                        output: new Float64Array([-0.9646563595586191, 0.9453435411944118, 0.947476378808811, -0.6191197959040455, -0.9578031240909408, -0.8534904817766975, 0.8395862433580278, 0.6166342921123096, -0.9443209468901351, -0.8537519678407616, 0.9802178891923058, 1.036184618827236]),
                        w: [-0.35803783696652025, -0.06876421243679295, 0.07928150319348358, 1.1254301108672202, 0.3089654633288927, 0.10832689435985716, -1.0623781211319985, -0.46813598594794603, -0.24412256230088375, -0.2303915992627718, -0.023769530097309522, 0.017571351755790176, -0.21746159955192837, -0.037840531453269675, 0.05015708895971939],
                        b: [0.15369312350992362, 0.39219665499505313, 0.2734587965085831, 0.09624289182746118, -0.07242717118758758]
                    },
                    99: {
                        loss: 0.012367665607340282,
                        output: new Float64Array([-0.9946631301834571, 0.9891910522736892, 0.9983605188515171, -0.6568943676522034, -1.0064252840834473, -0.8471375005346695, 0.8432597364976083, 0.6422159330288775, -0.9959470287468583, -0.9723955524973843, 0.9816507867046107, 1.0093927238682774]),
                        w: [-0.28052418167049925, -0.11821757753882559, 0.0020786753544130513, 1.140663170717235, 0.34261603706437693, -0.009036580021459007, -1.118922374523036, -0.3541603700415639, 0.006554906141269729, -0.1880901612950273, -0.06945631093302548, -0.011763967372050948, -0.2007512866400379, -0.05873762411460616, 0.003413638315995029],
                        b: [0.1151800401909634, 0.39455335324303586, 0.3387668480221665, 0.06372867502440176, -0.06853232983914795]
                    },
                }
            },
            {
                name: "Dense 3-7-9-1 (relu activation)",
                layers: [
                    {
                        size: 7,
                        activation: "relu",
                        w: [-0.009816238656640053, -0.07641565799713135, -0.5562934279441833, -0.48236939311027527, 0.39610323309898376, -0.09847478568553925, 0.27625757455825806, 0.3391346335411072, 0.20626778900623322, -0.5174019932746887, 0.36203762888908386, 0.2779529392719269, -0.11034822463989258, -0.39224210381507874, -0.042753513902425766, -0.48325595259666443, -0.25783607363700867, 0.3196316659450531, -0.27621254324913025, 0.22523315250873566, 0.3555835783481598],
                        b: [0.025604330003261566, 0.03606167808175087, 0.04736475646495819, -0.22672893106937408, 0.5388190746307373, 0.42851749062538147, -0.03892591968178749]
                    },
                    {
                        size: 9,
                        activation: "relu",
                        w: [0.09438163042068481, -0.19530880451202393, 0.07624875754117966, 0.047156479209661484, -0.23645731806755066, 0.23183803260326385, -0.25285252928733826, -0.04910960793495178, 0.23192913830280304, -0.2753773033618927, -0.10561291128396988, -0.03126037120819092, 0.3623618185520172, 0.09843490272760391, 0.3725736439228058, 0.15834982693195343, -0.040564704686403275, -0.15230882167816162, -0.34668323397636414, 0.17652671039104462, 0.1830541044473648, -0.16468319296836853, 0.05142129585146904, 0.05077752098441124, -0.2009655088186264, 0.11271536350250244, -0.30800768733024597, 0.0957983061671257, 0.14890766143798828, 0.27620914578437805, 0.33546969294548035, 0.3614346385002136, 0.2918977737426758, 0.20921817421913147, 0.35152000188827515, 0.2672884166240692, -0.2819427251815796, 0.2799402177333832, 0.019494442269206047, 0.2942894697189331, -0.15145237743854523, 0.272411584854126, -0.14931772649288177, -0.06308174133300781, 0.16880999505519867, 0.10149084031581879, -0.11543990671634674, -0.23870226740837097, 0.3320678174495697, -0.18848682940006256, 0.13020703196525574, 0.24445617198944092, -0.27712151408195496, 0.19604580104351044, -0.1943844109773636, -0.20220674574375153, -0.04877915978431702, -0.3770362138748169, -0.29488277435302734, -0.048340171575546265, 0.11050315946340561, 0.013166790828108788, -0.09942232072353363],
                        b: [0.3615165948867798, -0.05696748197078705, -0.0051620760932564735, -0.3096020221710205, -0.17117354273796082, -0.14638321101665497, 0.33592742681503296, 0.15159237384796143, -0.27946737408638]
                    },
                    {
                        size: 1,
                        activation: "",
                        w: [0.264132559299469, 0.28296607732772827, 0.07780234515666962, 0.256091833114624, 0.3169897496700287, -0.02076776884496212, -0.07246141135692596, -0.17978259921073914, -0.3075263202190399],
                        b: [0.06984639167785645]
                    },
                ],
                steps: {
                    0: {
                        loss: 0.5802159453900658,
                        output: new Float64Array([-0.09214433961750071, -0.08430026713108037, -0.08159682703861618, -0.09152245892329619, -0.09232619926480364, -0.09296330371854264, -0.08881603640477037, -0.08692105793438991, -0.09174181062861564, -0.09506886452018387, -0.08102623022538291, -0.09102622626214027]),
                        w: [0.17718372220587003, 0.1105842359237755, -0.3692935491091048, -0.2953694515549413, 0.5831030316823279, 0.08852501481989691, 0.08931905391287592, 0.1521350181858976, 0.019268070811192584, -0.33040217398506644, 0.1750378871491746, 0.09095327565920186, -0.297347795568476, -0.20524252658186315, -0.22975246752190262, -0.2962559676134606, -0.0708361163094102, 0.5066316014346735, -0.08921274201210125, 0.03823369169992222, 0.16858386623685048],
                        b: [-0.1613955135645902, -0.1509382673789329, 0.23436460613870028, -0.03972934345518375, 0.3518193964871412, 0.24151751803589055, -0.22592562224436555]
                    },
                    1: {
                        loss: 0.4986386345077212,
                        output: new Float64Array([-0.13507585195020888, -0.09243133744977602, -0.09155820984168651, -0.12196704320673413, -0.15141057215226272, -0.11905213195415171, -0.08917220715092847, -0.10670078075308471, -0.14943297794935542, -0.13709518128602777, -0.07821345499781147, -0.08044476100338735]),
                        w: [0.2908091014525026, 0.21899461138176893, -0.19564145259509458, -0.14687621713733662, 0.5522326357710323, 0.18580747634481284, 0.2271598272697666, -0.03509199639130603, -0.11655520392080679, -0.1585893276984632, -0.006185717520171996, -0.07884557497141179, -0.3348506655106346, -0.025060890496262866, -0.1358135749944059, -0.1663900724202456, 0.05539205065069536, 0.5755385207389933, 0.059832213065680734, -0.11410074471635961, -0.006749300277853615],
                        b: [-0.25222924546189923, -0.26354536874053436, 0.39522422163168347, 0.14265813835905256, 0.18366358674381786, 0.10979183635156892, -0.24641828042298022]
                    },
                    42: {
                        loss: 0.01293128463625854,
                        output: new Float64Array([-0.9631981272030452, 0.8842416481886253, 1.0325265482606114, -0.6607618462883845, -1.1078527963345017, -0.7976078510132318, 0.8367935292690183, 0.7216665341652264, -1.067355337623209, -0.8964695408864161, 1.1405917448015626, 0.9902858644603765]),
                        w: [0.006418993554524376, 0.05590566979357306, -0.09868001651500807, -0.08590352363247948, -0.08065573135587648, -0.019918518526618283, 0.6736993739496252, 0.0884097256021073, -0.011246602537960664, -0.2232867299414258, -0.138266702374685, -0.016642159999825754, -1.1201280540321144, -0.44727423976308417, -0.016253168860537147, -0.042614481241328966, 0.02196441126904962, -0.08682217347554075, 0.023913979404589215, -0.010237281255348958, -0.013105547569623427],
                        b: [0.11251852334086003, 0.007627262975376296, 0.3104708865738119, 0.0722361933598455, 0.2195750269406318, 0.010334956392555645, -0.061115794781233294]
                    },
                    99: {
                        loss: 0.016832271598686457,
                        output: new Float64Array([-0.9643151999434408, 0.8626249225923479, 1.0180518150730513, -0.6811319178586476, -1.1290687604412732, -0.7572267487078463, 0.8205017457274948, 0.6278580689986879, -1.0767922542409776, -0.8986375008158185, 1.1359554599625903, 0.9948685890699047]),
                        w: [0.2955890801854919, 0.06326215528071992, 0.0037724374619205947, -0.0015548329689497918, 0.0035784539616825974, 0.007053810744540033, 0.6834741872235781, 0.09909457503654523, -0.029597509177674626, -0.1370344804794359, -0.037996082592880044, 0.007004612626941941, -1.0934185472188611, -0.40253914807142105, 0.0682536590107611, -0.0016593353600086115, -0.0038973406997928972, -0.0009186951790307923, 0.0034239973918922502, 0.002253706292905523, 0.002046186165538698],
                        b: [0.07333784505755658, 0.00017818888840406637, 0.2619074564662807, 0.03258771982381222, 0.2558101206729677, -0.005122558802953705, 0.006003235792472293]
                    },
                }
            },
            {
                name: "Dense 3-6-12-24-1 (leaky relu)",
                layers: [
                    {
                        size: 6,
                        activation: "leaky-relu",
                        w: [0.28949448466300964, -0.021286699920892715, 0.00034398993011564016, 0.38297194242477417, -0.3849446177482605, 0.03329048678278923, -0.562038004398346, 0.010493344627320766, -0.12221649289131165, 0.47269192337989807, -0.4508518576622009, -0.34817492961883545, 0.4468616843223572, 0.055402886122465134, 0.057873308658599854, 0.45369386672973633, -0.40515998005867004, -0.5457025170326233],
                        b: [-0.3958270847797394, -0.3278323709964752, 0.5591441988945007, 0.06579609215259552, 0.5466641187667847, 0.328019380569458]
                    },
                    {
                        size: 12,
                        activation: "leaky-relu",
                        w: [-0.3946201503276825, 0.019630657508969307, 0.2633809447288513, -0.013703018426895142, 0.38869595527648926, 0.05305105820298195, -0.35546228289604187, 0.19700577855110168, -0.405229777097702, 0.14594140648841858, -0.3934001922607422, -0.143414705991745, -0.02117500826716423, -0.10729898512363434, -0.20708875358104706, 0.27257150411605835, 0.01064765639603138, -0.06891454756259918, 0.3794117569923401, -0.001496169250458479, -0.16936686635017395, -0.22761410474777222, 0.0013236934319138527, -0.2933572828769684, 0.18893182277679443, -0.04099901765584946, -0.20559462904930115, 0.27028512954711914, -0.35709336400032043, 0.15724946558475494, -0.1663379818201065, -0.15124766528606415, -0.359541654586792, -0.05520009621977806, -0.2915208637714386, -0.08928368240594864, 0.20480641722679138, 0.15024784207344055, 0.3766300082206726, -0.37745997309684753, 0.3902335464954376, -0.0593121163547039, 0.06881088763475418, 0.012994184158742428, 0.0678328275680542, -0.28544923663139343, 0.03843402490019798, 0.33594268560409546, -0.10427121818065643, -0.06925215572118759, -0.1509244590997696, 0.39839470386505127, -0.11472877860069275, 0.2418544590473175, -0.39864441752433777, -0.06220220401883125, -0.34803906083106995, 0.3822963833808899, 0.08459043502807617, -0.21775606274604797, -0.11837048083543777, -0.15187449753284454, -0.2963496148586273, -0.2093200832605362, -0.07257255911827087, -0.36203548312187195, -0.3466012477874756, -0.38245415687561035, -0.06641043722629547, -0.19930525124073029, 0.24211856722831726, 0.2638587951660156],
                        b: [-0.29708877205848694, 0.23729348182678223, -0.014436380937695503, 0.03545716404914856, -0.12740088999271393, 0.05536074563860893, 0.37483692169189453, 0.03755033016204834, -0.021048765629529953, 0.23397624492645264, -0.17951972782611847, -0.36386966705322266]
                    },
                    {
                        size: 24,
                        activation: "leaky-relu",
                        w: [-0.22007419168949127, 0.016888542100787163, 0.07340196520090103, 0.24329130351543427, 0.2010941505432129, -0.1421416848897934, -0.2808568477630615, -0.26142099499702454, 0.04116158187389374, -0.04539111629128456, -0.06966639310121536, -0.01966530829668045, 0.16788986325263977, -0.24952432513237, -0.21808572113513947, 0.15461134910583496, -0.03855787590146065, 0.1093028336763382, 0.04737342894077301, 0.22568219900131226, 0.10649193078279495, -0.12982098758220673, 0.20934684574604034, 0.08356250077486038, 0.1444275826215744, -0.022153040394186974, 0.19189564883708954, 0.1098356768488884, 0.14722414314746857, -0.08508560806512833, -0.08421055972576141, -0.14020441472530365, -0.1851932555437088, -0.012840294279158115, -0.2550673186779022, -0.1018768697977066, 0.2273971289396286, 0.22423985600471497, -0.1543794423341751, -0.17661535739898682, -0.010791772045195103, 0.1557275950908661, -0.1052800863981247, -0.08577755093574524, -0.20251505076885223, 0.25507861375808716, 0.12905851006507874, -0.0885087177157402, -0.08484447747468948, -0.08784671872854233, 0.08072283118963242, 0.06502720713615417, -0.1553480625152588, 0.03177966549992561, -0.052361659705638885, 0.26755133271217346, 0.24071083962917328, -0.11932183057069778, 0.13432838022708893, 0.18660493195056915, 0.2884318232536316, -0.1881311684846878, 0.04485568776726723, 0.0950356125831604, -0.23231704533100128, -0.0881873369216919, 0.08300157636404037, -0.2573467195034027, -0.1383499801158905, -0.20841552317142487, 0.06660372018814087, -0.07098601758480072, 0.14539767801761627, -0.2182343453168869, -0.26209256052970886, -0.2607210874557495, -0.24834513664245605, 0.07012583315372467, 0.142850860953331, -0.08918275684118271, -0.028408901765942574, -0.06275231391191483, 0.041346341371536255, -0.17359550297260284, 0.09953101724386215, 0.04609774798154831, -0.20415768027305603, -0.2868211567401886, 0.2690749168395996, -0.1666949838399887, 0.19481363892555237, -0.0633978322148323, 0.24481414258480072, 0.27792561054229736, 0.04007365554571152, 0.05396897718310356, 0.1477757841348648, 0.1671728789806366, 0.09685508161783218, 0.1936190128326416, -0.15828020870685577, 0.07343658059835434, 0.07710801064968109, 0.0650055930018425, -0.13276448845863342, -0.07884692400693893, -0.10100220143795013, 0.005625487770885229, -0.1540631651878357, 0.005761418025940657, 0.2768934369087219, 0.09439667314291, -0.07534150034189224, -0.1944703757762909, -0.2207842320203781, -0.2180195450782776, 0.13705410063266754, 0.16885218024253845, -0.1851406693458557, 0.13895541429519653, 0.2287820726633072, 0.1111731305718422, -0.14844325184822083, -0.25087955594062805, -0.1403309553861618, 0.04645821824669838, 0.13707102835178375, -0.21633782982826233, -0.2001287341117859, 0.09865927696228027, -0.15992599725723267, 0.12720344960689545, -0.0049711293540894985, 0.2600931227207184, -0.0577043779194355, -0.031177029013633728, 0.05077574774622917, 0.19778560101985931, -0.02462415210902691, 0.26343008875846863, 0.26479941606521606, -0.09093564003705978, 0.0027511967346072197, -0.1645297259092331, 0.07198099046945572, -0.16810576617717743, -0.08098949491977692, -0.06837508827447891, -0.1910112500190735, 0.15398955345153809, -0.11487725377082825, 0.017970066517591476, 0.20927825570106506, 0.25918978452682495, 0.28720006346702576, -0.2334614396095276, -0.24156688153743744, 0.23700107634067535, -0.2203388661146164, -0.09851708263158798, -0.12125582993030548, 0.18141452968120575, -0.09955012053251266, -0.034016288816928864, 0.050943683832883835, -0.270942360162735, -0.21267159283161163, -0.05173145979642868, -0.2595801055431366, -0.2709117531776428, 0.2881447374820709, -0.08751030266284943, -0.006579856853932142, 0.25561049580574036, 0.17270617187023163, -0.22146694362163544, -0.015272519551217556, 0.09023386240005493, -0.13379284739494324, 0.27285346388816833, -0.17486897110939026, 0.07661460340023041, -0.03440088406205177, 0.15561889111995697, 0.26420915126800537, -0.2382347285747528, -0.029445689171552658, -0.26091548800468445, -0.06303412467241287, 0.1224118173122406, -0.09731952100992203, -0.202353373169899, -0.11687680333852768, 0.13449369370937347, 0.0016093814047053456, -0.032156139612197876, 0.25229403376579285, 0.12701869010925293, 0.2116580307483673, 0.03824406862258911, 0.12753966450691223, 0.16883139312267303, -0.19551236927509308, 0.15843777358531952, -0.021927189081907272, 0.22681857645511627, -0.08639684319496155, -0.23758357763290405, 0.19358453154563904, -0.180266335606575, 0.1357397735118866, -0.11507143825292587, 0.03756844252347946, 0.21821042895317078, 0.03904557600617409, 0.18690966069698334, 0.006197943817824125, -0.16102994978427887, 0.10663993656635284, 0.0696382075548172, 0.24172742664813995, -0.14224936068058014, -0.0029124892316758633, -0.13330435752868652, 0.08743534982204437, 0.2516550123691559, -0.07165947556495667, 0.22310739755630493, -0.011691665276885033, 0.13539530336856842, 0.09649994224309921, 0.187615767121315, 0.1739484667778015, -0.26840272545814514, 0.1346256583929062, -0.26034554839134216, -0.11675380915403366, 0.09489603340625763, -0.0743367150425911, 0.04486735165119171, -0.24279893934726715, -0.09022261202335358, 0.25866207480430603, 0.23767238855361938, -0.18841876089572906, 0.21227268874645233, -0.07125718891620636, -0.0643421858549118, 0.19390635192394257, -0.05358228087425232, -0.282711923122406, -0.05033891275525093, -0.1913546472787857, -0.2866443395614624, -0.22816108167171478, -0.06669429689645767, -0.23341704905033112, -0.03252638876438141, 0.13973279297351837, 0.0954698696732521, 0.0561748668551445, -0.1889924556016922, 0.2632594704627991, -0.06513464450836182, 0.05058930069208145, 0.1309708207845688, 0.19713447988033295, -0.14838887751102448, -0.2188112735748291, -0.0751659944653511, 0.1972312182188034, 0.08517477661371231, 0.046826403588056564, -0.16014042496681213, -0.2632085680961609, -0.05810452997684479, -0.07333634048700333, -0.284091591835022, -0.13215462863445282, 0.1588350385427475, -0.28190743923187256, -0.1785557121038437, -0.2657303512096405, 0.21895718574523926, -0.16549548506736755, -0.09602081775665283, -0.14594800770282745, 0.22694073617458344],
                        b: [-0.23072978854179382, -0.031394001096487045, -0.16349804401397705, 0.13914082944393158, 0.004069583956152201, -0.1661747694015503, 0.16835196316242218, 0.28509265184402466, 0.05061758682131767, 0.26030194759368896, -0.04736042022705078, 0.18448668718338013, -0.07283938676118851, 0.15941651165485382, 0.2708441913127899, 0.012431849725544453, 0.11279138922691345, 0.2114516645669937, 0.20145104825496674, -0.06482568383216858, -0.10173288732767105, 0.10732285678386688, -0.24320940673351288, -0.13524726033210754]
                    },
                    {
                        size: 1,
                        activation: "",
                        w: [0.002166386693716049, -0.16290970146656036, 0.05174242705106735, 0.07651957124471664, -0.06064578518271446, -0.10256697237491608, -0.004580901935696602, 0.14556926488876343, 0.04128517955541611, 0.009088755585253239, 0.1802680343389511, -0.09438644349575043, 0.16020379960536957, -0.09966381639242172, 0.15816102921962738, 0.18147139251232147, -0.08076518028974533, 0.06533367931842804, 0.06620620936155319, 0.12348394840955734, -0.12749622762203217, -0.06567245721817017, 0.10774429142475128, -0.1569678783416748],
                        b: [0.08342675864696503]
                    },
                ],
                steps: {
                    0: {
                        loss: 0.4956035432724613,
                        output: new Float64Array([-0.38303421551510036, -0.22672255474220224, -0.18076610163721013, -0.3685889784532046, -0.4328071088568162, -0.27805306673087204, -0.13620816980544276, -0.2926060356980681, -0.43982316985037495, -0.42955511862309503, -0.1860915025075123, -0.0531765018535111]),
                        w: [0.10249479452208618, 0.16570901939071866, -0.18654744140589305, 0.19597215217699682, -0.19794481876495587, -0.15369553771241853, -0.37503822246825813, 0.19749317974757089, 0.06478319877843688, 0.6596917971042637, -0.2638522952886564, -0.16117517042594998, 0.6338615461913923, 0.24240257086489492, 0.2448727009337466, 0.266693902148686, -0.21816441529548986, -0.3587030624422405],
                        b: [-0.20882732674709312, -0.14083279767681828, 0.37214424916038724, 0.2527959973019178, 0.3596643057600132, 0.14101948364596592]
                    },
                    1: {
                        loss: 0.43385787432455764,
                        output: new Float64Array([0.31952422180437945, 1.5736678647383766, 1.935731559310652, 0.6372689607595072, 0.19300888673690464, 0.785870727904129, 1.5433075162226149, 1.2126427311289751, 0.16770265785146538, 0.21326592875028683, 1.9685075996247736, 1.7523720530589526]),
                        w: [-0.06404148886147071, 0.0437888646747899, -0.047980083165569204, 0.10991600266788513, -0.13410930853177053, -0.05687092966435406, -0.4871418474415237, 0.13298307566363043, -0.014681199074997098, 0.8204773504747498, -0.07889108515200824, 0.022990069264029023, 0.5402967528183547, 0.4295937853697846, 0.18924184899704366, 0.08898309437953478, -0.037367010030411096, -0.1751407455188083],
                        b: [-0.03262985387164674, 0.029889351774239403, 0.20040253894865143, 0.4201640365285606, 0.1979443458182446, -0.04310045287886155]
                    },
                    42: {
                        loss: 0.015029544066313549,
                        output: new Float64Array([-0.973403547285447, 0.8764506499583196, 0.9891865779181797, -0.7846325779680423, -1.0404334739015935, -0.8574835505352112, 0.7889334999631044, 0.6741265630219475, -1.019584517399757, -0.9443435911126772, 1.232645759606747, 0.9830636622532984]),
                        w: [-0.03560294991394988, 0.018195766483068906, 0.037354028900834106, 0.018870243362548736, -0.12978508013218348, 0.05544762431705096, -0.8394860306479394, -0.33757398580244036, 0.021082784473451546, 0.9113276990719145, 0.2347718125325506, -0.0898691453058616, -0.18655040064504924, 0.0645614586567401, 0.08629827484656619, -0.03903066963689744, -0.08899483827220378, -0.0678213836285307],
                        b: [0.02133372798330667, -0.09959417460915224, 0.17346475217195845, 0.3520139544833291, 0.0855863415227903, 0.010504704692604718]
                    },
                    99: {
                        loss: 0.010128591131531072,
                        output: new Float64Array([-0.9735161482450309, 0.9147434178366277, 0.9908846922956388, -0.7239679320198602, -1.0959241644514452, -0.8493400314471365, 0.8470784014993905, 0.7025710751879067, -1.0536193319975937, -0.9237866428834929, 1.1233197564471897, 0.9989961404136706]),
                        w: [0.015363286971419749, 0.010766328054092961, -0.001871508476625822, 0.05119344032368275, 0.010566425559615414, -0.004231731634513326, -0.9293714563116462, -0.3589232001998961, 0.09071590020893201, 0.7602220551586003, 0.15804594561702054, -0.07275617671423235, -0.047236701816566494, -0.011024852103057328, 0.006107613547456484, 0.0038926004768412292, -0.004414417263660542, -0.008400263168449466],
                        b: [0.0013424031623740303, 0.0188541427794684, 0.22811189461381176, 0.17698817987224313, 0.016767859678453522, -0.004335073391796342]
                    },
                }
            }
        ]

        for (let run of runs) {
            console.log(`%c${run.name}`, "font-weight: bold")
            this.TestNetwork(3, run.layers, data, 100, run.steps)
            console.log()
        }
    }

    TestNetwork(inputs, layers, data, steps, targetResults) {
        let network = new NeuralNetwork(inputs)

        for (let layer of layers)
            network.AddLayer({size: layer.size, activation: layer.activation})

        network.LoadWeights(layers)

        let learningRate = 0.187
        let criterion = new HuberLoss()
        let optimizer = new Adam(learningRate, {regularizationType: "l2", lambda: 0.02})

        for (let step = 0; step < steps; step++) {
            let loss = network.TrainOnBatchUnrolled(data.inputs, data.outputs, data.length, optimizer, criterion)
            let output = network.PredictUnrolled(data.inputs, data.length)

            if (!targetResults[step])
                continue

            console.log(`- step ${step}:`)
            this.CheckEqualFloat(`  - test loss`, loss, targetResults[step].loss)
            this.CheckEqualValues(`  - test output`, output, targetResults[step].output)
            this.CheckEqualValues(`  - test weights of first layer`, network.layers[0].w, targetResults[step].w)
            this.CheckEqualValues(`  - test biases of first layer`, network.layers[0].b, targetResults[step].b)
        }
    }
}
